<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenClaw Remote</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { width: 350px; font-family: -apple-system, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; }
        h1 { font-size: 16px; text-align: center; margin-bottom: 15px; }
        .card { background: white; border-radius: 10px; padding: 15px; margin-bottom: 10px; color: #333; }
        .card h3 { font-size: 13px; margin-bottom: 10px; color: #667eea; }
        .input-group { margin-bottom: 10px; }
        .input-group label { display: block; font-size: 11px; color: #666; margin-bottom: 5px; }
        .input-group input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 12px; }
        .btn { width: 100%; padding: 10px; border: none; border-radius: 8px; font-size: 13px; cursor: pointer; margin-bottom: 5px; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-success { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); color: white; }
        .btn-secondary { background: #f5f5f5; color: #333; }
        .status { text-align: center; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 12px; }
        .status.connected { background: rgba(102, 187, 106, 0.3); }
        .status.disconnected { background: rgba(239, 83, 80, 0.3); }
        .log { background: #1e1e1e; color: #00ff00; padding: 10px; border-radius: 8px; font-family: monospace; font-size: 10px; max-height: 80px; overflow-y: auto; white-space: pre-wrap; }
        .quick { display: flex; flex-wrap: wrap; gap: 5px; }
        .quick button { padding: 5px 10px; font-size: 10px; background: #f0f0f0; border: none; border-radius: 4px; cursor: pointer; }
        .quick button:hover { background: #667eea; color: white; }
    </style>
</head>
<body>
    <h1>ğŸ¤– OpenClaw Remote Control</h1>
    
    <div class="status disconnected" id="status">ğŸ”´ æœªè¿æ¥</div>
    
    <div class="card">
        <h3>ğŸ”— è¿æ¥æœåŠ¡å™¨</h3>
        <div class="input-group">
            <label>æœåŠ¡å™¨åœ°å€</label>
            <input type="text" id="server-url" placeholder="http://localhost:9999">
        </div>
        <button class="btn btn-primary" id="connect-btn">è¿æ¥</button>
        <button class="btn btn-danger" id="disconnect-btn" style="display:none;">æ–­å¼€è¿æ¥</button>
    </div>
    
    <div class="card">
        <h3>ğŸ“Š å¿«æ·æ“ä½œ</h3>
        <div class="quick">
            <button onclick="sendCommand('navigate', {url: 'https://www.10jqka.com.cn'})">åŒèŠ±é¡º</button>
            <button onclick="sendCommand('navigate', {url: 'https://quote.eastmoney.com'})">ä¸œæ–¹è´¢å¯Œ</button>
            <button onclick="sendCommand('getStockData')">è·å–ä»·æ ¼</button>
            <button onclick="sendCommand('getPageInfo')">é¡µé¢ä¿¡æ¯</button>
        </div>
    </div>
    
    <div class="card">
        <h3>ğŸ“‹ æ‰§è¡Œæ—¥å¿—</h3>
        <div class="log" id="log">ç­‰å¾…æ“ä½œ...</div>
    </div>

    <script>
        const statusEl = document.getElementById('status');
        const connectBtn = document.getElementById('connect-btn');
        const disconnectBtn = document.getElementById('disconnect-btn');
        const logEl = document.getElementById('log');
        
        let isConnected = false;
        
        // æ£€æŸ¥è¿æ¥çŠ¶æ€
        async function checkStatus() {
            const response = await chrome.runtime.sendMessage({ action: 'getStatus' });
            if (response?.success) {
                isConnected = response.connected;
                updateStatus();
            }
        }
        
        function updateStatus() {
            if (isConnected) {
                statusEl.className = 'status connected';
                statusEl.textContent = 'ğŸŸ¢ å·²è¿æ¥: ' + (response?.serverUrl || '');
                connectBtn.style.display = 'none';
                disconnectBtn.style.display = 'block';
            } else {
                statusEl.className = 'status disconnected';
                statusEl.textContent = 'ğŸ”´ æœªè¿æ¥';
                connectBtn.style.display = 'block';
                disconnectBtn.style.display = 'none';
            }
        }
        
        function log(msg, type = 'info') {
            const time = new Date().toLocaleTimeString();
            logEl.textContent = `[${time}] ${msg}\n` + logEl.textContent;
        }
        
        connectBtn.addEventListener('click', async () => {
            const url = document.getElementById('server-url').value;
            if (!url) {
                log('è¯·è¾“å…¥æœåŠ¡å™¨åœ°å€');
                return;
            }
            
            log('è¿æ¥ä¸­...');
            const response = await chrome.runtime.sendMessage({ action: 'connect', url });
            if (response.success) {
                log('âœ… è¿æ¥æˆåŠŸ');
                isConnected = true;
                updateStatus();
            } else {
                log('âŒ è¿æ¥å¤±è´¥');
            }
        });
        
        disconnectBtn.addEventListener('click', async () => {
            await chrome.runtime.sendMessage({ action: 'disconnect' });
            log('å·²æ–­å¼€è¿æ¥');
            isConnected = false;
            updateStatus();
        });
        
        async function sendCommand(type, params = {}) {
            if (!isConnected) {
                log('âŒ è¯·å…ˆè¿æ¥æœåŠ¡å™¨');
                return;
            }
            
            const command = { type, ...params };
            log(`æ‰§è¡Œ: ${type}`);
            
            const response = await chrome.runtime.sendMessage({
                action: 'execute',
                command: command
            });
            
            if (response.success) {
                const result = response.result || response;
                const text = typeof result === 'object' ? JSON.stringify(result, null, 2) : String(result);
                log(`âœ… ${text.substring(0, 100)}`, 'success');
            } else {
                log(`âŒ ${response.error}`, 'error');
            }
        }
        
        checkStatus();
    </script>
</body>
</html>
